#' Output print function (continuous exposure)
#'
#' @param h CarefullyCausal object
#'
#' @return Prints all output of Carefully Causal object
#' @export
#'
#' @examples
print.cccont <- function(h){
  outcome = as.character(h[[3]][[1]])
  covariates = as.character(h[[3]][[2]])
  exposure = as.character(h[[3]][[3]])
  df = h[[3]][[4]]
  family= as.character(h[[3]][[5]])
  result_type = as.character(h[[3]][[6]])
  min_estimate = as.character(round(min(h[[2]][[1]])),4)
  max_estimate = as.character(round(max(h[[2]][[1]])),4)


  cat("\nEstimand: Average Treatment Effect (Marginal) \n")

  if(family=="binomial" & result_type=="rr"){ # RR estimand

    cat(cat(cat(cat(paste0("E[",outcome,"^",exposure,"=a+1","]"))," /")," "),cat(paste0("E[",outcome,"^",exposure,"=a","]", "\n")))

  } else if (family=="binomial" & result_type=="log"){ #LOG(ODDS) estimand

    cat(cat(cat(cat(paste0("ln[ Odds(E[",outcome,"^",exposure,"=a+1","])"))," /")," "),cat(paste0("Odds(E[",outcome,"^",exposure,"=a","]) ]", "\n")))

  } else if (family=="binomial" & result_type=="or"){ #ODDS estimand

    cat(cat(cat(cat(paste0("Odds(E[",outcome,"^",exposure,"=a+1","])"))," /")," "),cat(paste0("Odds(E[",outcome,"^",exposure,"=a","])", "\n")))

  } else { #continuous outcome (originals scale of outcome, risk diff)

    cat(cat(cat(cat(paste0("E[",outcome,"^",exposure,"=a+1","]"))," -")," "),cat(paste0("E[",outcome,"^",exposure,"=a","]", "\n")))


  }


  if (covariates==""){
    cat(cat(cat("\nAdjustment Set:"), "None", sep = " "), "\n")
  } else {
    cat(cat(cat("\nAdjustment Set:"), covariates, sep = " "), "\n")
  }
  cat("*Please see output at $Estimand_interpretation for details \n \n")


  cat("\nTreatment effect: \n")
  h[[2]] <- format(round(output[[2]],3),nsmall=3) #to keep 000 as decimals
  print(h[[2]])
  if(family=="binomial" & result_type=="rr") {
    cat("\nInterpretation is in terms of risk ratio (rr) \n")
    cat("note: For outcome regression and IPTW, quasipoisson is deployed where only the estimate and CI are transformed into risk ratio. \n")

  } else if (family=="binomial" & result_type=="or"){
    cat("\nInterpretation is in terms of odds ratio (or) \n")
    cat("note: For outcome regression and IPTW, logistic regression is deployed where only the estimate and CI are transformed into odds ratio. \n")

  } else if (family=="binomial" & result_type=="log"){
    cat("\nInterpretation is in terms of log odds \n")
  }

  cat(cat(cat(cat("\nPlease evaluate whether the difference beteen the lowest estimate:"),min_estimate, sep = " "),"and highest:"),max_estimate,"is of substance, \n")
  cat("given the nature of the data. If so, evaluate the different modeling assumptions underlying each estimator.")
  cat("\n")
  cat("\n")


  cat("\nTo interpret these effects as causal, the following key assumptions must be satisfied: \n")

  if (covariates=="") {
    cat("\n[1] Marginal exchangeability: implies that,unconditionally,no confounding nor selection bias is present \n")
    cat("this is obtained in an ideal randomized experiment design \n")
  } else {
    cat(cat(cat("\n[1] Conditional exchangeability requires that adjusting for "), "\"", covariates,"\"",sep = ""),"is sufficient to completely eliminate ")
    cat(cat(cat(cat("all confounding and selection bias between "),"\"", exposure, "\"", sep = ""), " and ", sep = ""),"\"",outcome,"\"",sep = "")
    cat(". See the covariate balance table ($Assumptions$exchangeability$covariate_balance) ")
    cat("in the saved output and the corresponding explanations ($Assumptions$exchangeability$explanation). \n")
  }

  if (covariates==""){
    cat("\n[2] Positivity: is satisfied when,unconditionally, both exposed and unexposed individuals are observed \n")
    cat("as it is an unconditional setting,exposure should be assigned randomly with 0<Pr<1 \n")
  } else {
    cat("\n[2] Positivity: is satisfied when both exposed and unexposed (a+1 and a respectively) individuals are observed",
        "within every stratum of variables adjusted for (",covariates,").","A more in-depth explanation can be found at $Assumptions$positivity \n")
  }

  cat(cat(cat("\n[3] Consistency: implies that exposure"),paste0("'",exposure,"'")),"must be sufficiently well-defined so that any variation within \n")
  cat("the definition of the exposure would not result in a different outcome. See $Assumption$consistency \n")
  cat("for a more in-depth explanation and examples. \n")

  cat(cat(cat("\n[4] No interference: assumes that the exposure"),paste0("'",exposure,"'")), "applied to one unit does not affect the outcome of other units.\n")

  cat("\n[5] No measurement error: assumes that all variables were measured without substantial error, such that\n")
  cat("no substantial measurement bias is present. See $Assumptions$no_measurement_error for further explanation \n")

  cat("\n[6] Well-specified models: assumes that any models used are well-specified, meaning that they include all\n")
  cat("relevant non-linearities and/or statistical interactions\n")

}
